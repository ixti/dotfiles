#!/usr/bin/env bash

# See: https://github.com/aws/aws-cli/issues/6948#issuecomment-1128302905

message="$(aws sts get-caller-identity 2>&1)"
exit_code="$?"

case "$exit_code" in
  0)
    echo -e "\e[32mðŸ”‘ AWS SSO credentials are valid.\e[0m"
    ;;

  255)
    echo -e "\e[33mðŸ”‘ AWS SSO credentials are expired. Logging in...\e[0m"
    exec aws sso login
    ;;

  *)
    echo -e "\e[31mðŸ”‘ Something went wrong...\e[0m" >&2
    echo "$message" >&2
    exit $exit_code
esac
